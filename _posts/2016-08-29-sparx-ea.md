---
layout: post
title: "Did you ever wish you had better Diagrams?"
tags: [sparx, doc, arc42]
---

Let's recap what we did so far: in order to kickstart a documentation project, we've created a dual gradle / maven asciidoc build with included arc42 template in two languages and easy textual diagram drawing with planUML. That's already quite a feature list!

But what if plantUML diagrams are not enough for your needs? What if you can't rely on the auto-layout feature of plantUML?

One solution would be to just start up your favourite diagramming tool, draw your diagrams, export them and reference them from asciidoc. No problem. But what if you need to update one of the diagrams? Or you just worked the whole day on some diagrams and you don't know anymore which ones to re-export?

Wouldn't it be nice if your build just takes care of it? It could just search for your diagrams files and export them.

That's exactly what we will add today. Since there are two many diagramming tools on the market to include them all in one post, I will stick to [Sparx Enterprise Architect](http://www.sparxsystems.com/). Enterprise Architect - or short jsut EA - is a powerful but yet affordable tool which can be easily scripted.

There are several options for scripting like internal scripts written in [JavaScript, JScript and VBScript](http://www.sparxsystems.com/enterprise_architect_user_guide/12.1/automation_and_scripting/the_scripter_window.html). These scripts have to be invoked manually from within the application. Another option is to use the [automation interface](http://www.sparxsystems.com/enterprise_architect_user_guide/12.1/automation_and_scripting/usingtheautomationinterface.html) and "remote control" the application from outside. This can be done in various languages (all which have access to the ActiveX COM interface). There is a java bridge included and VBS would be the native approach.

In the past I already played around with the included java interface and had the feeling that it is a little bit incomplete or buggy. That's why I soon switched to VisualBasic as scripting for EA - this avoids an additional layer between me and the application.

The script I want to include into our build will have several tasks:

* find all EA repositories within the project
* open the found repositories through EA
* export all diagrams and save them with their given name as file name
* as bonus, check all element notes and export those which start with {adoc: filename}

I've chose to use the given name of a diagram for the file name because I think it is easier to handle and speaks for itself. Drawback is that you have to make sure that the name is a valid file name and it is unique. Another aproach would be to use the quite cryptic object ID (GUID)

What's up with the bonus tasks? Working with EA, I like to directly write my comments and descriptions in the note fields of the diagram elements. By prefixing them with {adoc: filename}, I can decide to export and easily include them into my documentation. This way, the written documentation for a diagram can be directly maintained within EA.


