<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><title><![CDATA[R.D.Müller - Bits from my Brain]]></title><link href="/categories/grails/atom.xml" rel="self"/><link href="/"/><updated>2016-06-26T18:03:39+02:00</updated><id>/</id><author><name><![CDATA[Ralf D. Müller]]></name><email><![CDATA[ralf.d.mueller@gmail.com]]></email></author><generator uri="http://sysgears.com/grain/">Grain</generator><entry><title type="html"><![CDATA[Serialize a Map as JSON or YAML]]></title><link href="/blog/2016/04/06/serialize-a-map-as-json-or-yaml/"/><updated>2016-06-27T20:29:23+02:00</updated><id>/blog/2016/04/06/serialize-a-map-as-json-or-yaml/</id><content type="html"><![CDATA[<p>When working in a web environment, you often have to transfer arbitrary data like lists or maps as String of the network.<!--more--></p>
<p>The followin Gist shows how to solve this by serializing a list or map as JSON or YAML. In addition, it
shows how Groovy does it an a very elegant and clean way.</p>
<p><script src="https://gist.github.com/rdmueller/793d262862270eda8d3a0b5c2e9e46da.js"></script></p>
]]></content></entry><entry><title type="html"><![CDATA[Domain Class Diagrams for Grails Projects]]></title><link href="/blog/2015/08/14/domain-class-diagrams-for-grails-projects/"/><updated>2016-06-27T20:29:08+02:00</updated><id>/blog/2015/08/14/domain-class-diagrams-for-grails-projects/</id><content type="html"><![CDATA[<p>A Grails project can quickly grow into larger applications. In order to still keep an overview, some architecture documentation is quite useful. One of the most useful diagrams to dive into an application is the domain class diagrams which shows you how your business or domain object interact.<!--more--></p>
<p>There are a lot of tools on the market which let you analyze and reverse engineer your project in order to draw such a class diagram. They fall in two categories:</p>
<ul>
<li>Tools which automatically create and layout your diagram</li>
<li>Tools which let you manually enhance the diagram after discovering your classes</li>
</ul>
<p>For the first category, there are some Grails plugins which use tools like PlantUML to draw the needed diagrams right from within the Grails framework. That's great to get a quick overview, but since you can't easily enhance the diagrams with additional information or lay out the elements with your wisdom, I don't like them to create my project documentation.</p>
<p>There are great tools within the second categroy, but unfortunately, I am not aware of a single one which is capable of doing the trick for Groovy classes - only Java ones. Some of them are highly configurable and it would be possible to teach them how to work with Groovy. But the effort to do so is high. For Enterprise Architect by Sparx Systems, you need Groovy descirbe as EBNF - I am currently not aware of an EBNF description and it would be hard to create and maintain one by myself.</p>
<p>So what to do? Groovy already looks like Java and Grails knows about its domain classes. So my approach is to use a script which takes the knowledge about the domain classes available within grails and creates Java classes from it.</p>
<p>These classes then can be easily fed into whatever UML tool you chose. As Result, you will have</p>
<ul>
<li>an easy way to export and synchronize your Grails domain classes to any UML tool capable of analyzing Java sources</li>
<li>depending on you Tool, you are free to manually add your knowledge and lay out the diagrams as you like</li>
<li>most tools keep your manual layout and additions even when you re-synchronize the diagrams with your code</li>
</ul>
<h2>Details of the Solution</h2>
<p>As already mentioned, I use the information already available in Grails. In order to do so, I wrote a Grails script which is invoked from the command line. The following Gist shows you the code.</p>
<p><script src="https://gist.github.com/rdmueller/acee3a5db5ea3273652b.js"></script></p>
<p>Unfortunately, Grails only knows about the code, not the comments which are available within the source. So I added a little dirty hack which fetches the source of the domain class and extracts the first comment - hopefully the description of the domain class - and adds it to the java sources.</p>
<p>In order to make it even more convenient, you can check out your UML-Tool and see if it let's you automate the synchronisation with your generated code.</p>
<h2>Example</h2>
<p>Here is an example diagram for the <a href="https://github.com/grails-samples/grails-petclinic">Grails PetClinic sample application</a> created with <a href="http://sparxsystems.com/">Enterprise Architect</a>.</p>
<div style="text-align: center;">
<img src="../images/petclinic.png" style="max-width:100%;" />
</div>
]]></content></entry><entry><title type="html"><![CDATA[Spock-Reports for Grails 2.5]]></title><link href="/blog/2015/07/16/spock-reports-for-grails-2-5/"/><updated>2016-06-27T20:29:01+02:00</updated><id>/blog/2015/07/16/spock-reports-for-grails-2-5/</id><content type="html"><![CDATA[<p>In two previous posts (<a href="https://rdmueller.github.io/Spock-Reports-with-Grails-3.0/">Grails3.0</a> &amp; <a href="https://rdmueller.github.io/Spock-Reports-with-Grails-2.2/">Grails2.2</a>) I described how to use <a href="https://github.com/renatoathaydes/spock-reports">Spock-Reports</a> with <a href="http://www.grails.org">Grails 3.0</a> and Grails 2.2.<!--more--></p>
<p>Now, if you try to use it with Grails 2.5, it seems not to work from the start. The main problem I noticed was that even
when I run a trivial app and all spock tests are auto-created, I got an error message at the end of the tests:
http://stackoverflow.com/questions/31440381/forked-grails-vm-exited-with-error-while-running-test-app#comment50863764_31440381</p>
<p>So I tried to get rid of this error message by not forking the VM when running tests. To do that, simply set the fork-configuration
to <code>false</code> for the test environments (in <code>BuildConfig.groovy</code>)</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">grails</span><span class="o">.</span><span class="na">project</span><span class="o">.</span><span class="na">fork</span> <span class="o">=</span> <span class="o">[</span>
</span><span class='line'>    <span class="o">...</span>
</span><span class='line'>    <span class="nl">test:</span> <span class="kc">false</span><span class="o">,</span>
</span><span class='line'>    <span class="o">...</span>
</span><span class='line'><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>
<p>Now, the rest seems to work the same as with Grails 2.2.4 with the only difference that Grails 2.5 uses Spock out of the box.
So we don't habe to configure it:</p>
<p>just open your <code>grails-app/conf/BuildConfig.groovy</code> file and add</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">repositories</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="c1">//for spock-reports</span>
</span><span class='line'>  <span class="n">mavenRepo</span> <span class="s2">&quot;http://jcenter.bintray.com&quot;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the <code>repositories</code> section and</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">dependencies</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="c1">//for spock-reports</span>
</span><span class='line'>  <span class="n">test</span> <span class="s1">&#39;com.athaydes:spock-reports:1.2.5&#39;</span>  
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the <code>dependencies</code> section.</p>
<p>The standard reports are now generated and stored in <code>build/spock-reports/.</code>.</p>
<h3>Customizing your Reports</h3>
<p>In order to store the generated reports in <code>target/test-reports/spock/.</code> you have to customize your reports as described in the <a href="https://github.com/renatoathaydes/spock-reports#customizing-the-reports">documentation</a>, you have to create a file called <code>META-INF/services/com.athaydes.spockframework.report.IReportCreator.properties</code>.
That sounds easier than it is, because it has to be in the classpath and for some Grails projects, it's not easy to find the right folder to put it.</p>
<p>For Grails 2.5, you will succeed by putting it in <code>grails-app/conf/META-INF/services/com.athaydes.spockframework.report.IReportCreator.properties</code>.</p>
<p>Here is a sample file which uses the template based reports:</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="err">#</span> <span class="n">Name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">implementation</span> <span class="kd">class</span> <span class="nc">of</span> <span class="n">the</span> <span class="n">report</span> <span class="n">creator</span>
</span><span class='line'><span class="err">#</span> <span class="n">Currently</span> <span class="n">supported</span> <span class="n">classes</span> <span class="nl">are:</span>
</span><span class='line'><span class="err">#</span>   <span class="mi">1</span><span class="o">.</span> <span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">HtmlReportCreator</span>
</span><span class='line'><span class="err">#</span>   <span class="mi">2</span><span class="o">.</span> <span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">IReportCreator</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">Output</span> <span class="n">directory</span> <span class="o">(</span><span class="n">where</span> <span class="n">the</span> <span class="n">spock</span> <span class="n">reports</span> <span class="n">will</span> <span class="n">be</span> <span class="n">created</span><span class="o">)</span> <span class="o">-</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">outputDir</span><span class="o">=</span><span class="n">target</span><span class="s">/test-reports/</span><span class="n">spock</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">If</span> <span class="n">set</span> <span class="n">to</span> <span class="kc">true</span><span class="o">,</span> <span class="n">hides</span> <span class="n">blocks</span> <span class="n">which</span> <span class="k">do</span> <span class="n">not</span> <span class="n">have</span> <span class="n">any</span> <span class="n">description</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">hideEmptyBlocks</span><span class="o">=</span><span class="kc">false</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">Set</span> <span class="n">properties</span> <span class="n">of</span> <span class="n">the</span> <span class="n">report</span> <span class="n">creator</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">specTemplateFile</span><span class="o">=</span><span class="s">/spockreporttemplate/</span><span class="n">spec</span><span class="o">-</span><span class="n">template</span><span class="o">.</span><span class="na">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">reportFileExtension</span><span class="o">=</span><span class="n">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">summaryTemplateFile</span><span class="o">=</span><span class="s">/spockreporttemplate/</span><span class="n">summary</span><span class="o">-</span><span class="n">template</span><span class="o">.</span><span class="na">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">summaryFileName</span><span class="o">=</span><span class="n">summary</span><span class="o">.</span><span class="na">md</span>
</span></code></pre></td></tr></table></div></figure>
<p>this file specifies that the templates are located in <code>grails-app/conf/spockreporttemplates</code> and the output
will be written to <code>target/test-reports/spock</code>. A good idea is to start with the default templates <a href="https://github.com/renatoathaydes/spock-reports/blob/master/src/main/resources/templateReportCreator/spec-template.md">spec-template.md</a> and <a href="https://github.com/renatoathaydes/spock-reports/blob/master/src/main/resources/templateReportCreator/summary-template.md">summary-template.md</a></p>
<p>You might want to use this https://github.com/rdmueller/Grails2.5-Spock-Reports-Sample as a starting point...</p>
]]></content></entry><entry><title type="html"><![CDATA[Spock-Reports for Grails 2.2]]></title><link href="/blog/2015/07/14/spock-reports-for-grails-2-2/"/><updated>2016-06-27T20:28:54+02:00</updated><id>/blog/2015/07/14/spock-reports-for-grails-2-2/</id><content type="html"><![CDATA[<p>In a <a href="https://rdmueller.github.io/Spock-Reports-with-Grails-3.0/">previous post</a> I described how to use <a href="https://github.com/renatoathaydes/spock-reports">Spock-Reports</a> with <a href="http://www.grails.org">Grails 3.0</a>.<!--more--></p>
<p>That was easy since Grails 3.0 is Gradle based.</p>
<p>Now I will try to figure out how to use Spock-Reports with Grails 2.2.4 .</p>
<p>Again, the configuration of the dependencies is easy: just open your <code>grails-app/conf/BuildConfig.groovy</code> file and add</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">repositories</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="c1">//for spock-reports</span>
</span><span class='line'>  <span class="n">mavenRepo</span> <span class="s2">&quot;http://jcenter.bintray.com&quot;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the <code>repositories</code> section and</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">dependencies</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="c1">//for spock-reports</span>
</span><span class='line'>  <span class="n">test</span> <span class="s1">&#39;com.athaydes:spock-reports:1.2.5&#39;</span>  
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the <code>dependencies</code> section. But since Grails 2.2.4 does not include Spock be default, we also have to follow the
<a href="https://grails.org/plugin/spock">documentation for the Grails-Spock-Plugin</a> and add in addition</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">plugins</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>	<span class="n">test</span><span class="o">(</span><span class="s2">&quot;:spock:0.7&quot;</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>	    <span class="c1">//since we use groovy 2.x with grails 2.2.4</span>
</span><span class='line'>      	    <span class="n">exclude</span> <span class="s2">&quot;spock-grails-support&quot;</span>
</span><span class='line'>    	<span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the plugins section and</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">dependencies</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="n">test</span> <span class="s1">&#39;org.spockframework:spock-grails-support:0.7-groovy-2.0&#39;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the dependencies section. Now, that should do the trick. The standard reports are now generated and stored in <code>build/spock-reports/.</code>.</p>
<h3>Customizing your Reports</h3>
<p>In order to store the generated reports in <code>target/test-reports/spock/.</code> you have to customize your reports as described in the <a href="https://github.com/renatoathaydes/spock-reports#customizing-the-reports">documentation</a>, you have to create a file called <code>META-INF/services/com.athaydes.spockframework.report.IReportCreator.properties</code>.
That sounds easier than it is, because it has to be in the classpath and for some Grails projects, it's not easy to find the right folder to put it.</p>
<p>For Grails 2.2.4, you will succeed by putting it in <code>grails-app/conf/META-INF/services/com.athaydes.spockframework.report.IReportCreator.properties</code>.</p>
<p>Here is a sample file which uses the template based reports:</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="err">#</span> <span class="n">Name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">implementation</span> <span class="kd">class</span> <span class="nc">of</span> <span class="n">the</span> <span class="n">report</span> <span class="n">creator</span>
</span><span class='line'><span class="err">#</span> <span class="n">Currently</span> <span class="n">supported</span> <span class="n">classes</span> <span class="nl">are:</span>
</span><span class='line'><span class="err">#</span>   <span class="mi">1</span><span class="o">.</span> <span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">HtmlReportCreator</span>
</span><span class='line'><span class="err">#</span>   <span class="mi">2</span><span class="o">.</span> <span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">IReportCreator</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">Output</span> <span class="n">directory</span> <span class="o">(</span><span class="n">where</span> <span class="n">the</span> <span class="n">spock</span> <span class="n">reports</span> <span class="n">will</span> <span class="n">be</span> <span class="n">created</span><span class="o">)</span> <span class="o">-</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">outputDir</span><span class="o">=</span><span class="n">target</span><span class="s">/test-reports/</span><span class="n">spock</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">If</span> <span class="n">set</span> <span class="n">to</span> <span class="kc">true</span><span class="o">,</span> <span class="n">hides</span> <span class="n">blocks</span> <span class="n">which</span> <span class="k">do</span> <span class="n">not</span> <span class="n">have</span> <span class="n">any</span> <span class="n">description</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">hideEmptyBlocks</span><span class="o">=</span><span class="kc">false</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">Set</span> <span class="n">properties</span> <span class="n">of</span> <span class="n">the</span> <span class="n">report</span> <span class="n">creator</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">specTemplateFile</span><span class="o">=</span><span class="s">/spockreporttemplate/</span><span class="n">spec</span><span class="o">-</span><span class="n">template</span><span class="o">.</span><span class="na">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">reportFileExtension</span><span class="o">=</span><span class="n">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">summaryTemplateFile</span><span class="o">=</span><span class="s">/spockreporttemplate/</span><span class="n">summary</span><span class="o">-</span><span class="n">template</span><span class="o">.</span><span class="na">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">summaryFileName</span><span class="o">=</span><span class="n">summary</span><span class="o">.</span><span class="na">md</span>
</span></code></pre></td></tr></table></div></figure>
<p>this file specifies that the templates are located in <code>grails-app/conf/spockreporttemplates</code> and the output
will be written to <code>target/test-reports/spock</code>. A good idea is to start with the default templates <a href="https://github.com/renatoathaydes/spock-reports/blob/master/src/main/resources/templateReportCreator/spec-template.md">spec-template.md</a> and <a href="https://github.com/renatoathaydes/spock-reports/blob/master/src/main/resources/templateReportCreator/summary-template.md">summary-template.md</a></p>
<p>You might want to use this https://github.com/rdmueller/Grails2.2-Spock-Reports-Sample as a starting point...</p>
]]></content></entry><entry><title type="html"><![CDATA[Spock-Reports for Grails 3.0]]></title><link href="/blog/2015/07/11/spock-reports-for-grails-3-0/"/><updated>2016-06-27T20:28:39+02:00</updated><id>/blog/2015/07/11/spock-reports-for-grails-3-0/</id><content type="html"><![CDATA[<p><a href="https://github.com/renatoathaydes/spock-reports">Spock-Reports</a> is a great way to create better reports for <a href="https://github.com/spockframework/spock">Spock</a>.<!--more--></p>
<p>Since Grails 3.0 is based on Gradle, integrating the Spock-Reports is easy. Just open your <code>build.gradle</code> file and add</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">repositories</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="c1">//for spock-reports</span>
</span><span class='line'>  <span class="n">jcenter</span><span class="o">()</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the <code>repositories</code> section and</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="n">dependencies</span> <span class="o">{</span>
</span><span class='line'>  <span class="o">[...]</span>
</span><span class='line'>  <span class="c1">//for spock-reports</span>
</span><span class='line'>  <span class="n">testCompile</span> <span class="s1">&#39;com.athaydes:spock-reports:1.2.5&#39;</span>  
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
<p>to the <code>dependencies</code> section.</p>
<p>that's it... The next time you run <code>grails test-app</code>, you'll find the generated Spock-Reports in <code>/build/spock-reports/</code></p>
<h3>Customizing your Reports</h3>
<p>If you want to customize your reports as described in the <a href="https://github.com/renatoathaydes/spock-reports#customizing-the-reports">documentation</a>, you have to create a file called <code>META-INF/services/com.athaydes.spockframework.report.IReportCreator.properties</code>. That sounds easier than it is, because it has to be in the classpath and for some Grails projects, it's not easy to find the right folder to put it.</p>
<p>For Grails 3.0, you will succeed by putting it in <code>src/test/resources/META-INF/services/com.athaydes.spockframework.report.IReportCreator.properties</code>.</p>
<p>Here is a sample file which uses the template based reports:</p>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='groovy'><span class='line'><span class="err">#</span> <span class="n">Name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">implementation</span> <span class="kd">class</span> <span class="nc">of</span> <span class="n">the</span> <span class="n">report</span> <span class="n">creator</span>
</span><span class='line'><span class="err">#</span> <span class="n">Currently</span> <span class="n">supported</span> <span class="n">classes</span> <span class="nl">are:</span>
</span><span class='line'><span class="err">#</span>   <span class="mi">1</span><span class="o">.</span> <span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">internal</span><span class="o">.</span><span class="na">HtmlReportCreator</span>
</span><span class='line'><span class="err">#</span>   <span class="mi">2</span><span class="o">.</span> <span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">IReportCreator</span><span class="o">=</span><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span>
</span><span class='line'>
</span><span class='line'><span class="err">#</span> <span class="n">Output</span> <span class="n">directory</span> <span class="o">(</span><span class="n">where</span> <span class="n">the</span> <span class="n">spock</span> <span class="n">reports</span> <span class="n">will</span> <span class="n">be</span> <span class="n">created</span><span class="o">)</span> <span class="o">-</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">working</span> <span class="n">directory</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">outputDir</span><span class="o">=</span><span class="n">build</span><span class="s">/spock-reports-mds</span>
</span><span class='line'>
</span><span class='line'><span class="s"># If set to true, hides blocks which do not have any description</span>
</span><span class='line'><span class="s">com.athaydes.spockframework.report.hideEmptyBlocks=false</span>
</span><span class='line'>
</span><span class='line'><span class="s"># Set properties of the report creator</span>
</span><span class='line'><span class="s">com.athaydes.spockframework.report.template.TemplateReportCreator.specTemplateFile=/</span><span class="n">spockreporttemplate</span><span class="s">/spec-template.md</span>
</span><span class='line'><span class="s">com.athaydes.spockframework.report.template.TemplateReportCreator.reportFileExtension=md</span>
</span><span class='line'><span class="s">com.athaydes.spockframework.report.template.TemplateReportCreator.summaryTemplateFile=/</span><span class="n">spockreporttemplate</span><span class="o">/</span><span class="n">summary</span><span class="o">-</span><span class="n">template</span><span class="o">.</span><span class="na">md</span>
</span><span class='line'><span class="n">com</span><span class="o">.</span><span class="na">athaydes</span><span class="o">.</span><span class="na">spockframework</span><span class="o">.</span><span class="na">report</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">TemplateReportCreator</span><span class="o">.</span><span class="na">summaryFileName</span><span class="o">=</span><span class="n">summary</span><span class="o">.</span><span class="na">md</span>
</span></code></pre></td></tr></table></div></figure>
<p>this file specifies that the templates are located in <code>src/test/resources/spockreporttemplates</code>. A good idea is to start with the default templates <a href="https://github.com/renatoathaydes/spock-reports/blob/master/src/main/resources/templateReportCreator/spec-template.md">spec-template.md</a> and <a href="https://github.com/renatoathaydes/spock-reports/blob/master/src/main/resources/templateReportCreator/summary-template.md">summary-template.md</a></p>
<p>You might want to use this https://github.com/rdmueller/Grails3.0-Spock-Reports-Sample as a starting point...</p>
]]></content></entry></feed>